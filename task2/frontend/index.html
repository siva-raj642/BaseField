<!DOCTYPE html>
<html>
<head>
<title>Form</title>
</head>
<body>

<form id="myForm" method="POST">
  <label>Name</label><br>
  <input id="name" type="text" style="width:100%; padding:5px;">
  <small id="nameErr" style="color:red;"></small>
  <br><br>

  <label>Email</label><br>
  <input id="email" type="text" style="width:100%; padding:5px;">
  <small id="emailErr" style="color:red;"></small>
  <br><br>

  <label>Password</label><br>
  <input id="password" type="password" style="width:100%; padding:5px;">
  <small id="passErr" style="color:red;"></small>
  <div id="invalid"></div>
  <br><br>

  <label>Confirm Password</label><br>
  <input id="cpassword" type="password" style="width:100%; padding:5px;">
  <small id="cpassErr" style="color:red;"></small>
  <br><br>

  <button type="submit" style="padding:6px 12px;">Submit</button>

</form>

<script>
    document.getElementById("myForm").addEventListener("submit", function(e){

    e.preventDefault();   

    let name = document.getElementById("name").value.trim();
    let email = document.getElementById("email").value.trim();
    let pass = document.getElementById("password").value.trim();
    let cpass = document.getElementById("cpassword").value.trim();

    let isValid = true;
    

    
    document.getElementById("nameErr").innerText = "";
    document.getElementById("emailErr").innerText = "";
    document.getElementById("passErr").innerText = "";
    document.getElementById("cpassErr").innerText = "";

    
    if(name === ""){
        document.getElementById("nameErr").innerText = "Name cannot be empty";
        isValid = false;
    }

    if(email === ""){
        document.getElementById("emailErr").innerText = "Email cannot be empty";
        isValid = false;
    }

    if(pass === ""){
        document.getElementById("passErr").innerText = "Password cannot be empty";
        isValid = false;
    }

    
    if(name.length < 3){
        document.getElementById("nameErr").innerText = "Name must be at least 3 characters";
        isValid = false;
    }
    function containsUppercase(str) {
        return /[A-Z]/.test(str);
    }
    function hasNumber(myString) {
        return /\d/.test(myString);
    }


    if(pass.length < 9 || !containsUppercase(pass) || !hasNumber(pass) ){
        document.getElementById("passErr").innerText = "Password is in invalid format";
        isValid = false;
    }
    document.getElementById("invalid").innerText="The Password must contain atleast one Capital letter , one Number and it must be above 8 character "

    
    let pattern = /^[^\s@]+@[^\s@]+\.[^\s@]+$/;
    if(email !== "" && !pattern.test(email)){
        document.getElementById("emailErr").innerText = "Email is not valid";
        isValid = false;
    }

    if(pass != cpass){
        document.getElementById("cpassErr").innerText="Password must match";
        isValid = false;
    }

    if(isValid){
        alert("Form Submitted Successfully ");
        const data ={name,email,pass,cpass};
        const res = fetch("http://localhost:3000/submit",{
        method:"POST",
        headers: {
            "Content-Type": "application/json"
        },
        body:JSON.stringify(data)
        })  .then(response => response.json())
            .then(result => {
                console.log(result);
                alert(result.message);
        })
            .catch(err => {
                console.error("Request failed", err);
        });
    }

});
</script>
</body>
</html>
